(this.webpackJsonpreels=this.webpackJsonpreels||[]).push([[0],{29:function(e){e.exports=JSON.parse('{"apiKey":"AIzaSyAYE6Jh5EwL0n0AHRSwSJtvsHEtoTAWxqo","authDomain":"reels-2e788.firebaseapp.com","databaseURL":"https://reels-2e788-default-rtdb.firebaseio.com","projectId":"reels-2e788","storageBucket":"reels-2e788.appspot.com","messagingSenderId":"792395930864","appId":"1:792395930864:web:1ac5e38af4ed381e6bb635"}')},41:function(e,t,c){},42:function(e,t,c){},47:function(e,t,c){},48:function(e,t,c){"use strict";c.r(t);var n=c(2),a=c(28),s=c.n(a),o=c(19),r=c(5),i=c(31),l=c(12),u=c(14),d=c.n(u),j=c(16),b=c(18),p=(c(37),c(50),c(49),c(29));b.a.initializeApp(p);var m=new b.a.auth.GoogleAuthProvider,h=b.a.auth(),f=b.a.firestore(),O=b.a.storage(),x=(b.a,c(1)),v=Object(n.createContext)(),g=function(e){var t=Object(n.useState)(null),c=Object(l.a)(t,2),a=c[0],s=c[1],o=Object(n.useState)(!0),r=Object(l.a)(o,2),i=r[0],u=r[1];return Object(n.useEffect)((function(){h.onAuthStateChanged(function(){var e=Object(j.a)(d.a.mark((function e(t){var c,n,a,o,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=10;break}return c=t.displayName,n=t.email,a=t.uid,o=t.photoURL,r=f.collection("users").doc(a),e.next=5,r.get();case 5:e.sent.exists||r.set({displayName:c,email:n,photoURL:o}),s({displayName:c,email:n,uid:a,photoURL:o}),e.next=11;break;case 10:s(null);case 11:u(!1);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]),Object(x.jsx)(v.Provider,{value:a,children:!i&&e.children})},N=(c(41),function(e){var t,c=Object(n.useContext)(v),a=Object(n.useState)(!1),s=Object(l.a)(a,2),o=s[0],r=s[1],i=Object(n.useState)(""),u=Object(l.a)(i,2),b=u[0],p=u[1],m=Object(n.useState)(!1),h=Object(l.a)(m,2),O=h[0],g=h[1],N=Object(n.useState)([]),k=Object(l.a)(N,2),w=k[0],y=k[1];return c&&(t=e.data.likes.includes(c.uid)),Object(n.useEffect)((function(){(function(){var t=Object(j.a)(d.a.mark((function t(){var c,n,a,s;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:c=e.data.comments,n=[],a=0;case 3:if(!(a<c.length)){t.next=11;break}return t.next=6,f.collection("comments").doc(c[a]).get();case 6:s=t.sent,n.push(s.data());case 8:a++,t.next=3;break;case 11:y(n);case 12:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[e]),Object(x.jsxs)("div",{className:"video-card",children:[Object(x.jsx)("p",{className:"video-card-username",children:e.data.name}),Object(x.jsxs)("span",{className:"video-card-music",children:[Object(x.jsx)("span",{class:"material-icons",children:"music_note"}),Object(x.jsx)("marquee",{children:"some song"})]}),Object(x.jsx)("span",{class:"material-icons-outlined video-card-comment",onClick:function(e){g(!O)},children:"chat"}),Object(x.jsx)("span",{class:"material-icons-outlined video-card-like",onClick:function(){var n=e.data.likes;if(t){for(var a=[],s=0;s<n.length;s++)n[s]!==c.uid&&a.push(n[s]);n=a}else n.push(c.uid);f.collection("posts").doc(e.data.id).update({likes:n})},children:t?"favorite":"favorite_border"}),O?Object(x.jsxs)("div",{className:"video-card-comment-box",children:[Object(x.jsx)("div",{className:"actual-comments",children:w.map((function(e){return Object(x.jsxs)("div",{className:"post-user-comment",children:[Object(x.jsx)("img",{alt:"",src:e.photo}),Object(x.jsxs)("div",{children:[Object(x.jsx)("h5",{children:e.name}),Object(x.jsx)("p",{children:e.comment})]})]})}))}),Object(x.jsxs)("div",{className:"comment-form",children:[Object(x.jsx)("input",{type:"text",value:b,onChange:function(e){p(e.currentTarget.value)}}),Object(x.jsx)("button",{onClick:Object(j.a)(d.a.mark((function t(){var n,a,s,o,r;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f.collection("comments").add({name:c.displayName,comment:b,photo:c.photoURL});case 2:return n=t.sent,p(""),t.next=6,n.get();case 6:return a=t.sent,s=a.id,t.next=10,f.collection("posts").doc(e.data.id).get();case 10:return o=t.sent,(r=o.data().comments).push(s),t.next=15,f.collection("posts").doc(e.data.id).update({comments:r});case 15:case"end":return t.stop()}}),t)}))),children:"Post"})]})]}):"",Object(x.jsx)("video",{onClick:function(e){o?(e.currentTarget.pause(),r(!1)):(e.currentTarget.play(),r(!0))},loop:!0,src:e.data.url,className:"video-card-video"})]})}),k=(c(42),function(){var e=Object(n.useContext)(v),t=Object(n.useState)([]),c=Object(l.a)(t,2),a=c[0],s=c[1];return Object(n.useEffect)((function(){f.collection("posts").onSnapshot((function(e){for(var t=e.docs,c=[],n=0;n<t.length;n++)c.push(Object(i.a)({id:t[n].id},t[n].data()));s(c)}))}),[]),Object(x.jsxs)(x.Fragment,{children:[e?"":Object(x.jsx)(r.a,{to:"/login"}),Object(x.jsx)("div",{className:"video-container",children:a.map((function(e){return Object(x.jsx)(N,{data:e},e.id)}))}),Object(x.jsx)("button",{className:"home-logout-btn",onClick:function(){h.signOut()},children:Object(x.jsx)("span",{class:"material-icons ds",children:"logout"})}),Object(x.jsx)(o.b,{to:"/Profile",children:Object(x.jsx)("button",{id:"profile",children:Object(x.jsx)("span",{class:"material-icons sd",children:"account_circle"})})}),Object(x.jsx)("input",{className:"dfg",type:"file",onClick:function(e){e.currentTarget.value=null},onChange:function(t){var c=t.currentTarget.files[0],n=c.name,a=c.size,s=c.type;if((a/=1e6)>10)alert("file size exceeds 10mb");else if("video"===(s=s.split("/")[0])){var o=O.ref("/posts/".concat(e.uid,"/").concat(Date.now()+"-"+n)).put(c);o.on("state_changed",(function(){}),(function(){}),(function(){o.snapshot.ref.getDownloadURL().then((function(t){console.log(t),f.collection("posts").add({name:e.displayName,url:t,likes:[],comments:[]})}))}))}else alert("Please upload a video file")}})]})}),w=function(){var e=Object(n.useContext)(v);return Object(x.jsxs)(x.Fragment,{children:[e?Object(x.jsx)(r.a,{to:"/"}):"",Object(x.jsx)("button",{className:"btn btn-primary m-4",onClick:function(){h.signInWithPopup(m)},children:"Login with google"})]})},y=(c(47),function(){var e=Object(n.useContext)(v),t=Object(n.useState)(0),c=Object(l.a)(t,2),a=c[0],s=c[1];return Object(n.useEffect)((function(){(function(){var t=Object(j.a)(d.a.mark((function t(){var c;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f.collection("posts").where("name","==",e.displayName).get();case 2:c=t.sent,s(c.size);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("h1",{className:"asd",children:"PROFILE PAGE"}),e?Object(x.jsxs)("div",{children:[Object(x.jsx)("img",{className:"img-profile",src:e.photoURL,alt:""}),Object(x.jsx)("p",{className:"username-profile",children:e.displayName}),Object(x.jsxs)("p",{className:"ttpost",children:["Total Posts: ",a]})]}):Object(x.jsx)(r.a,{to:"/Login"})]})}),C=function(){return Object(n.useEffect)((function(){}),[]),Object(x.jsx)(x.Fragment,{children:Object(x.jsx)(g,{children:Object(x.jsx)(o.a,{children:Object(x.jsxs)(r.d,{children:[Object(x.jsx)(r.b,{exact:!0,path:"/Login",children:Object(x.jsx)(w,{})}),Object(x.jsx)(r.b,{exact:!0,path:"/Profile",children:Object(x.jsx)(y,{})}),Object(x.jsx)(r.b,{exact:!0,path:"/",children:Object(x.jsx)(k,{})})]})})})})};s.a.render(Object(x.jsx)(C,{}),document.getElementById("root"))}},[[48,1,2]]]);
//# sourceMappingURL=main.a445621c.chunk.js.map